<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, shrink-to-fit=no">
  <title>Dashboard - 3TPT</title>
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="180x180" href="/img/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/img/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/jpeg" sizes="440x332" href="/img/5ton.jpg">
  <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
  <link rel="stylesheet" href="/fonts/fontawesome-all.min.css">
  <link rel="stylesheet" href="/css/Data-Table-1.css">
  <link rel="stylesheet" href="/css/Data-Table.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.20/b-1.6.1/b-colvis-1.6.1/b-flash-1.6.1/b-html5-1.6.1/r-2.2.3/datatables.min.css" />
  <style>
    .signature {
      border: 1px solid black;
      width: 70%;
      margin: auto;
      display: block;
    }

    /* Center the loader */

    #loader {
      position: absolute;
      left: 55%;
      top: 50%;
      z-index: 1;
      width: 150px;
      height: 150px;
      margin: -75px 0 0 -75px;
      border: 16px solid #f3f3f3;
      border-radius: 50%;
      border-top: 16px solid #3498db;
      width: 120px;
      height: 120px;
      -webkit-animation: spin 2s linear infinite;
      animation: spin 2s linear infinite;
    }

    @-webkit-keyframes spin {
      0% {
        -webkit-transform: rotate(0deg);
      }

      100% {
        -webkit-transform: rotate(360deg);
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Add animation to "page content" */

    .animate-bottom {
      position: relative;
      -webkit-animation-name: animatebottom;
      -webkit-animation-duration: 1s;
      animation-name: animatebottom;
      animation-duration: 1s
    }

    @-webkit-keyframes animatebottom {
      from {
        bottom: -100px;
        opacity: 0
      }

      to {
        bottom: 0px;
        opacity: 1
      }
    }

    @keyframes animatebottom {
      from {
        bottom: -100px;
        opacity: 0
      }

      to {
        bottom: 0;
        opacity: 1
      }
    }

    .modal-pane {
      width: 100%;
      flex: 0 0 100%;
      display: flex;
      flex-direction: column;
      justify-content: start;
      padding: 6px;
      overflow-y: scroll;
    }

    #modal-create-rac-panes {
      transition: transform 0.8s ease-in-out;
    }

    .modal-pane::-webkit-scrollbar {
      width: 3px;
    }

    /*https://stackoverflow.com/questions/3790935/can-i-hide-the-html5-number-input-s-spin-box*/

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type=number] {
      -moz-appearance: textfield;
      /* Firefox */
    }

    #content {
      display: flex;
      flex-direction: column;
    }

    @media(max-width: 768px) {
      #wrapper {
        height: 80vh;
      }
    }
    
    #completerac {
      margin-top: 10px
    }
  </style>
</head>

<body id="page-top" class="sidebar-toggled">
  <div id="wrapper" class="animate-bottom">
    <nav class="navbar navbar-dark align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0 toggled" id="nav-bar">
      <div class="container-fluid d-flex flex-column p-0">
        <a class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0 nav-link-history disabled" href="index" id="nav-brand">
          <div class="sidebar-brand-icon rotate-n-15"><i class="fas fa-truck-moving"></i></div>
          <div class="sidebar-brand-text mx-3"><span>3TPT</span></div>
        </a>
        <hr class="sidebar-divider my-0">
        <ul class="nav navbar-nav text-light" id="accordionSidebar">
          <li class="nav-item" role="presentation">
            <a class="nav-link active nav-link-history disabled" href="index" id="nav-index">
              <i class="fas fa-tachometer-alt"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link nav-link-history disabled" href="detail" id="nav-detail">
              <i class="fas fa-car-side"></i>
              <span>Detail</span>
            </a>
          </li>
        </ul>
        <div class="text-center d-none d-md-inline">
          <button class="btn rounded-circle border-0" id="sidebarToggle" type="button"></button>
        </div>
      </div>
    </nav>
    <div class="d-flex flex-column" id="content-wrapper">
      <nav class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top" style="flex: 0 0 auto;">
        <div class="container-fluid">
          <button class="btn btn-link d-md-none rounded-circle mr-3" id="sidebarToggleTop" type="button"><i class="fas fa-bars"></i></button>
          <ul class="nav navbar-nav flex-nowrap ml-auto">
            <li class="nav-item dropdown d-sm-none no-arrow">
              <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false" href="">
                <i class="fas fa-search"></i>
              </a>
              <div class="dropdown-menu dropdown-menu-right p-3 animated--grow-in" role="menu" aria-labelledby="searchDropdown">
                <form class="form-inline mr-auto navbar-search w-100">
                  <div class="input-group">
                    <input class="bg-light form-control border-0 small" type="text" placeholder="Search for ...">
                    <div class="input-group-append">
                      <button class="btn btn-primary py-0" type="button"><i class="fas fa-search"></i></button>
                    </div>
                  </div>
                </form>
              </div>
            </li>
            <li class="nav-item dropdown no-arrow mx-1" role="presentation">
              <div class="nav-item dropdown no-arrow">
                <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false" href="">
                  <span class="badge badge-danger badge-counter"><!--insertable number--></span>
                  <i class="fas fa-bell fa-fw"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-list dropdown-menu-right animated--grow-in" role="menu">
                  <h6 class="dropdown-header">test</h6>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="mr-3">
                      <div class="bg-primary icon-circle"><i class="fas fa-file-alt text-white"></i></div>
                    </div>
                    <div><span class="small text-gray-500">test</span>
                      <p>test</p>
                    </div>
                  </a>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="mr-3">
                      <div class="bg-success icon-circle"><i class="fas fa-donate text-white"></i></div>
                    </div>
                    <div><span class="small text-gray-500">test</span>
                      <p>test</p>
                    </div>
                  </a>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="mr-3">
                      <div class="bg-warning icon-circle"><i class="fas fa-exclamation-triangle text-white"></i></div>
                    </div>
                    <div><span class="small text-gray-500">test</span>
                      <p>test</p>
                    </div>
                  </a>
                  <a class="text-center dropdown-item small text-gray-500" href="">Show All Alerts</a>
                </div>
              </div>
            </li>
            <li class="nav-item dropdown no-arrow mx-1" role="presentation">
              <div class="nav-item dropdown no-arrow">
                <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false" href="">
                  <i class="fas fa-envelope fa-fw"></i>
                  <span class="badge badge-danger badge-counter"><!--insertable number--></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-list dropdown-menu-right animated--grow-in" role="menu">
                  <h6 class="dropdown-header">test</h6>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="dropdown-list-image mr-3">
                      <img class="rounded-circle" src="/img/avatars/avatar4.jpeg" />
                      <div class="bg-success status-indicator"></div>
                    </div>
                    <div class="font-weight-bold">
                      <div class="text-truncate"><span>test</span></div>
                      <p class="small text-gray-500 mb-0">test</p>
                    </div>
                  </a>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="dropdown-list-image mr-3">
                      <img class="rounded-circle" src="/img/avatars/avatar2.jpeg" />
                      <div class="status-indicator"></div>
                    </div>
                    <div class="font-weight-bold">
                      <div class="text-truncate"><span>test</span></div>
                      <p class="small text-gray-500 mb-0">test</p>
                    </div>
                  </a>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="dropdown-list-image mr-3">
                      <img class="rounded-circle" src="/img/avatars/avatar3.jpeg" />
                      <div class="bg-warning status-indicator"></div>
                    </div>
                    <div class="font-weight-bold">
                      <div class="text-truncate"><span>test</span></div>
                      <p class="small text-gray-500 mb-0">test</p>
                    </div>
                  </a>
                  <a class="d-flex align-items-center dropdown-item" href="">
                    <div class="dropdown-list-image mr-3">
                      <img class="rounded-circle" src="/img/avatars/avatar5.jpeg" />
                      <div class="bg-success status-indicator"></div>
                    </div>
                    <div class="font-weight-bold">
                      <div class="text-truncate"><span>test</span></div>
                      <p class="small text-gray-500 mb-0">test</p>
                    </div>
                  </a>
                  <a class="text-center dropdown-item small text-gray-500" href="">Show All Alerts</a>
                </div>
              </div>
              <div class="shadow dropdown-list dropdown-menu dropdown-menu-right" aria-labelledby="alertsDropdown"></div>
            </li>
            <div class="d-none d-sm-block topbar-divider"></div>
            <li class="nav-item dropdown no-arrow" role="presentation">
              <div class="nav-item dropdown no-arrow">
                <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false" href="">
                  <span class="d-none d-lg-inline mr-2 text-gray-600 small" id="name-holder"></span>
                  <img class="border rounded-circle img-profile" src="/img/avatars/avatar5.jpeg">
                </a>
                <div class="dropdown-menu shadow dropdown-menu-right animated--grow-in" role="menu">
                  <a class="dropdown-item" role="presentation" href="">
                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                    &nbsp;test
                  </a>
                  <a class="dropdown-item" role="presentation" href="">
                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                    &nbsp;test
                  </a>
                  <a class="dropdown-item" role="presentation" href="">
                    <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                    &nbsp;test
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" role="presentation" href="logout">
                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                    &nbsp;Logout
                  </a>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </nav>
      <div id="content" style="flex: 1 1 0;">
        <!--Index Page -->
        <div id="page-index" class="container-fluid page currentPage">
          <div class="d-sm-flex justify-content-between align-items-center mb-4">
            <h3 class="text-dark mb-0">Dashboard (Placeholder)</h3>
          </div>
          
          <div class="my-auto">
            
            <div id="demo" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ul class="carousel-indicators">
              <li data-target="#demo" data-slide-to="0" class="active"></li>
              <li data-target="#demo" data-slide-to="1"></li>
            </ul>
            <!-- The slideshow -->
            <div class="carousel-inner" role="listbox" style="width:100%; !important;">
              <div class="carousel-item active">
                <img class="img-fluid" src="https://www.mindef.gov.sg/web/wcm/connect/army/34b5dbb6-da55-4da5-8082-dfb29ca4aa91/Transport.jpg?MOD=AJPERES&CACHEID=ROOTWORKSPACE.Z18_1QK41482L8HD90QOSSLBSG3000-34b5dbb6-da55-4da5-8082-dfb29ca4aa91-mo-rZ4f" alt="">
                <div class="carousel-caption d-none d-md-block">
                  <h5>Placeholder image</h5>
                  <p>This is a test image</p>
                </div>
              </div>
              <div class="carousel-item">
                <img class="img-fluid" src="https://www.mindef.gov.sg/web/wcm/connect/army/34b5dbb6-da55-4da5-8082-dfb29ca4aa91/Transport.jpg?MOD=AJPERES&CACHEID=ROOTWORKSPACE.Z18_1QK41482L8HD90QOSSLBSG3000-34b5dbb6-da55-4da5-8082-dfb29ca4aa91-mo-rZ4f" alt="">
                <div class="carousel-caption d-none d-md-block">
                  <h5>Placeholder image 2</h5>
                  <p>This is another test image</p>
                </div>
              </div>
            </div>
            <!-- Left and right controls -->
            <a class="carousel-control-prev" href="#demo" data-slide="prev">
              <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#demo" data-slide="next">
              <span class="carousel-control-next-icon"></span>
            </a>
          </div>
          </div>
          
        </div>

        <!--Details Page-->
        <div id="page-detail" class="container-fluid d-none page" style="height: 100%;">

          <div class="card shadow" style="height: 100%;">
            <div class="card-header py-3">
              <p class="text-primary m-0 font-weight-bold">Details and RAC</p>
            </div>
            <div class="card-body" style="overflow-y: scroll;flex: 1 1 0;">
              <div class="row">
              </div>
              <div class="table-responsive table mt-2" id="userDetailTable" role="grid" aria-describedby="dataTable_info">
                <table class="table dataTable my-0" id="userDetailTableInner">
                  <thead>
                    <tr>
                      <th>Date Start</th>
                      <th>Detail Name</th>
                      <th>Vehicle</th>
                      <th>Risk</th>
                      <th>RAC</th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td><strong>Date Start</strong></td>
                      <td><strong>Detail Name</strong></td>
                      <td><strong>Vehicle</strong></td>
                      <td><strong>Risk</strong></td>
                      <td><strong>RAC</strong></td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer class="bg-white sticky-footer" style="flex: 0 0 auto;">
        <div class="container my-auto">
          <div class="text-center my-auto copyright"><span>(placeholder) Copyright Â© 3TPT 2019</span></div>
        </div>
      </footer>
    </div>
    <a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
  </div>

  <div id="modal-create-rac" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Create RAC</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="height: 60vh; max-height: 600px; padding:0;overflow: hidden;">
          <div id="modal-create-rac-panes" style="transform: translateX(0);width: 100%;height: 100%;display: flex; flex-direction: row;">
            <div class="modal-pane"
              style="background-color:#4e73df;color: #FFF;justify-content: center;text-align: center;">
              Follow the steps to create an RAC
              <div>
                <button class="btn btn-nextPane">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem; color:#FFF;"></i>
                </button>                
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5> Journey Information </h5>
              <form class="needs-validation" novalidate>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <input type="text" class="form-control" name="journeyfrom" placeholder="Journey From" required>
                  </div>
                  <div class="form-group col-md-6">
                    <input type="text" class="form-control" name="journeyto" placeholder="Journey To" required>
                  </div>
                </div>

                <h5> Vehicle Information </h5>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <input type="number" class="form-control" name="vehno" placeholder="Vehicle No." max="99999" required>
                  </div>
                  <div class="form-group col-md-6">
                    <input type="text" class="form-control" id="vehavi" name="vehavi" placeholder="Last AVI Date" onfocus="(this.type='date')" required>
                  </div>
                </div>

              <h5> About & Standing Orders </h5>
              <a href="https://cdn.glitch.com/f8b62283-ccac-4a89-b0d8-991d640eb2ba%2F5gomGFZ.png?v=1573291454015"
                class="btn btn-sm btn-info" target="_blank">View</a>
              <hr>
              <div class="form-group">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="haveread" required>
                  <label class="form-check-label" for="haveread">I have read RAC About & Standing Orders</label>
                </div>
              </div>
              </form>
              
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Driver's / Rider's Experience
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th>Driving Experience</th>
                      <th>Riding Experience</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>CAT A/B</td>
                      <td>4000km & Above</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="drv-experience" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td>CAT C</td>
                      <td>1000km & Above</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="drv-experience" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td>CAT D</td>
                      <td>Below 1000km</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="drv-experience" value="High" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Never been trained/familiarised in vehicle that you are driving/riding</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="drv-experience" value="No Move" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">No JIT Done</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="drv-experience" value="No Move" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Vehicle / Motorcycle Type
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th>Vehicle</th>
                      <th>Motorcycle</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">Same as last detail</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="veh-type" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td>GP Car/Pickup</td>
                      <td>200CC</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="veh-type" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td>Class 3</td>
                      <td>800CC</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="veh-type" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td>Class 4</td>
                      <td>800CC</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="veh-type" value="High" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Fatigue
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Length of Rest</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">More than 7 hours</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="fatigue" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Less than 7 hours (In camp/home)</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="fatigue" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Less than 7 hours (Field)</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="fatigue" value="High" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Less than 4 hours (Field)</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="fatigue" value="No Move" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Health
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Condition</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">Good</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="health" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Fair (Just recovered from illness)</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="health" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Poor (Ill or still under medication that cause drowsiness)</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="health" value="No Move" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Weather
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Condition</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">Dry</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="weather" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Wet</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="weather" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Heavy Showers</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="weather" value="High" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Route Familiarity
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Level</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">Familiar</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="familiarity" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Not familiar even after route brief done</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="familiarity" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Not familiar as route brief is not done</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="familiarity" value="No Move" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Mission
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Type</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">Admin</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="mission" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Training/Operations(Including towing)</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="mission" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">All administrative towing</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="mission" value="High" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Without Vehicle Commander
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Driver's Experience</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">CAT A, B</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="no-vcom" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">CAT C</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="no-vcom" value="Medium" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">CAT D</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="no-vcom" value="High" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Vehicle Commander Present</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="no-vcom" value="N/A" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Vehicle / Motorcycle Serviceability
              </h5>
              <form class="needs-validation" novalidate>
                <table class="table" style="margin: 8px;width: calc(100% - 16px);">
                  <thead>
                    <tr>
                      <th colspan="2">Fault Severity</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">No fault</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="servicibility" value="Low" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Minor Fault</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="servicibility" value="High" required />
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">Major Fault</td>
                      <td style="position: relative;">
                        <input class="form-check-input" type="radio" name="servicibility" value="No Move" required />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </form>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Permit holder / VCOM / Front passsenger checklist table (Placeholder)
              </h5>
              <img src="https://cdn.glitch.com/f8b62283-ccac-4a89-b0d8-991d640eb2ba%2F784hNNo.png?v=1573486243200">
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col" id="evalRisk">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>
            
           <div class="modal-pane" style="text-align: center;">
              <h5>Overall Risk:</h5>
              <h5 class="overall-risk"></h5>
             <div>
               <pre class="takenote"></pre>
             </div>
              <h5>Transport Operator's Signature</h5>
              <canvas id="signature-user" class="signature"></canvas>
              <button id="clear-sign-user" class="btn btn-danger canvas-clear">Clear</button>
             
              
             <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col" data-action="save-sign" data-sign-target="signature-officer" data-sign-name="officersign">
                <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>Overall Risk:</h5>
              <h5 class="overall-risk"></h5>
              <div>
               <pre class="takenote"></pre>
             </div>
              <h5>Countersigning Officer</h5>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="officerChk">
                <label class="form-check-label" for="officerChk">No Countersigning Officer Present</label>
              </div>
              <hr>
              <div id="officerPage" class="">
                <!--<div id="create-rac-summary">                Edit summary system to add it here too                    -->
                <form class="needs-validation" id="officerForm" novalidate>
                  <div class="form-group" id="officersafetymeasures">
                    <textarea type="text" class="form-control" id="officermitigation" name="officermitigation" placeholder="Please elaborate on the safety or risk mitigating measures taken"></textarea>
                  </div>
                  <div class="form-group">
                      <input type="text" class="form-control" id="officerreleasedispatchtime" name="officerreleasedispatchtime" onfocus="(this.type='time')" placeholder="Release/Dispatch Time">
                  </div>
                  <div class="form-row">
                    <div class="form-group col-4">
                      <input type="text" class="form-control" id="officerrank" name="officerrank" placeholder="Rank" required>
                    </div>
                    <div class="form-group col-8">
                      <input type="text" class="form-control" id="officername" name="officername" placeholder="Name" required>
                    </div>
                  </div>
                </form>
                <canvas id="signature-officer" class="signature"></canvas>
                <button id="clear-sign-officer" class="btn btn-danger canvas-clear">Clear</button>
              </div>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col" data-action="save-sign" data-sign-target="signature-officer" data-sign-name="officersign">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>

            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>Overall Risk:</h5>
              <h5 class="overall-risk"></h5>
              <div>
               <pre class="takenote"></pre>
             </div>
              <h5>Vehicle Commander</h5>
              <!--<div id="create-rac-summary">                Edit summary system to add it here too                    -->
              <form class="needs-validation" novalidate>
                <div class="form-group" id="vcomsafetymeasures">
                  <textarea type="text" class="form-control" id="vcommitigation" name="vcommitigation" placeholder="Please elaborate on the safety or risk mitigating measures taken"></textarea>
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="vcomreleasedispatchtime" name="vcomreleasedispatchtime" onfocus="(this.type='time')" placeholder="Release/Dispatch Time">
                </div>
                <div class="form-row">
                  <div class="form-group col-4">
                    <input type="text" class="form-control" id="vcomrank" name="vcomrank" placeholder="Rank" required>
                  </div>
                  <div class="form-group col-8">
                    <input type="text" class="form-control" id="vcomname" name="vcomname" placeholder="Name" required>
                  </div>
                </div>
              </form>
              <canvas id="signature-vcom" class="signature"></canvas>
              <button id="clear-sign-vcom" class="btn btn-danger canvas-clear">Clear</button>
              <div class="row">
                <button class="btn btn-prevPane col">
                  <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
                <button class="btn btn-nextPane col" data-action="save-sign|gen-summary" data-sign-target="signature-vcom" data-sign-name="vcomsign" data-summary="create-rac-summary">
                  <i class="far fa-arrow-alt-circle-right" style="font-size: 2.5rem;color:#4e73df;"></i>
                </button>
              </div>
            </div>

            <div class="modal-pane" style="text-align: center;">
              <h5>
                Final overview of rac form
              </h5>
              <hr>
              <!--<div id="create-rac-summary">                Edit summary system to add it here too                    -->
                <div id="create-rac-summary">
                
              </div>
              <hr>
              <button class="btn btn-primary" id="completerac" data-dismiss="modal">Complete</button>
              <button class="btn btn-prevPane col">
                <i class="far fa-arrow-alt-circle-left" style="font-size: 2.5rem;color:#4e73df;"></i>
              </button>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/jquery.min.js"></script>
  <script src="/bootstrap/js/bootstrap.min.js"></script>
  <script src="/js/chart.min.js"></script>
  <script src="/js/bs-charts.js"></script>
  <!--<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.js"></script>
  <script type="text/javascript"
    src="https://cdn.datatables.net/v/bs4/dt-1.10.20/b-1.6.1/b-colvis-1.6.1/b-flash-1.6.1/b-html5-1.6.1/r-2.2.3/datatables.min.js"></script>
  <script src="/js/theme.js"></script>
  <script>
    let detailData = [
      ['15/10/2019', 'Sembawang Wharves', 'PSV', '-'],
      ['16/10/2019', 'Sembawang Wharves', 'PSV', '-'],
      ['17/10/2019', '9SIR Live Firing', '5Ton', '-'],
      ['18/10/2019', '9SIR Outfield', '5Ton', '-'],
      ['19/10/2019', '9SIR IPPT', 'SOUV', '-'],
      ['20/10/2019', 'IDTC House Visit', 'OUV', '-'],
      ['21/10/2019', 'DIV ICT IPPT', 'SOUV', '-'],
      ['22/10/2019', 'Sembawang Wharves', 'PSV', '-'],
      ['23/10/2019', 'Sembawang Wharves', 'PSV', '-'],
      ['24/10/2019', '9SIR Live Firing', '5Ton', 'Low'],
      ['25/10/2019', '9SIR Outfield', '5Ton', 'High'],
      ['26/10/2019', '9SIR IPPT', 'SOUV', 'Med'],
      ['27/10/2019', 'IDTC House Visit', 'OUV', 'Low'],
      ['30/10/2019', 'DIV ICT IPPT', 'SOUV', '-'],
      ['31/10/2019', 'WPT2', 'SOUV', '-']
    ];

    var userId;
    var username;
    var rank;
    var name;
    var node;
    var isadmin;

    var today = new Date();
    var ayearback = new Date();
    var dd = today.getDate();
    var mm = today.getMonth() + 1; //January is 0!
    var yyyy = today.getFullYear();
    if (dd < 10) {
      dd = '0' + dd
    }
    if (mm < 10) {
      mm = '0' + mm
    }
    today = yyyy + '-' + mm + '-' + dd;
    ayearback = yyyy-1 + '-' + mm + '-' + dd;
    
    $(document).ready(function () {
      $('.nav-link-history').removeClass("disabled");
    });

    document.body.onload = function () {
      /*setTimeout(()=>{
        document.getElementById("loader").style.display = "none";
        document.getElementById("wrapper").classList.remove ('d-none');
      }, 1000);*/

      let cookies = document.cookie;
      //token is first cookie
      let tokenCookie = cookies.split(';')[0];
      let token = tokenCookie.replace('access_token=', '');
      let show = new Event('show');

      initCreateModal();
      
      //load table
      for (let i = 0; i < detailData.length; i++) {
        const row = createElement('tr', {},
                      createElement('td', {}, detailData[i][0]),
                      createElement('td', {}, detailData[i][1]),
                      createElement('td', {}, detailData[i][2]),
                      createElement('td', {}, detailData[i][3]),
                      createElement('td', {}, 
                        createElement('button', {className: 'btn btn-primary', onclick: () => {
                          $('#modal-create-rac').modal('show');
                        }}, 'Create'),
                        createElement('button', {className: 'btn btn-secondary', style: {marginLeft: '4px'}, onclick: () => {
                          
                        }}, 'View'),
                      ),
                    );
        document.getElementById('userDetailTableInner').children[1].appendChild(row);            
      }

      //jquery data table
      var table = $('#userDetailTableInner').DataTable({
        "order": [0, 'desc'],
        dom: 'lBfrtip',
        buttons: [{
          text: 'Create Detail',
          action: function () {
            //reloadDetailDataTable()
            alert('Create Detail WIP')
          }
        }]
      });
      $('.dataTables_length').addClass('bs-select');

      //Fetching user data (one time)
      fetch('/me.json')
        .then(
          function (response) {
            if (response.status !== 200) {
              console.log('Looks like there was a problem. Status Code: ' +
                response.status);
              return;
            }
            response.json().then(data => {
              console.log(JSON.stringify(data));
              //Set user variables here
              userId = data.id;
              username = data.username;
              rank = data.rank;
              name = data.name;
              node = data.node;
              isadmin = data.isadmin;
              document.getElementById("name-holder").innerHTML = rank + " " + name;
            })
              .then(() => {
                console.log('thenfetch', userId, username, rank, name, node, isadmin)
              });
          }
        )
        .catch(function (err) {
          console.log('Fetch Error :-S', err);
        });

      //Fetching data in interval (table updates, alerts etc)
      /*setTimeout(()=>{
        fetch('/intervalData.json')
        .then(
          function(response) {
            if (response.status !== 200) {
              console.log('Looks like there was a problem. Status Code: ' +
                response.status);
              return;
            }
            response.json().then(function(data) {
              console.log(JSON.stringify(data));
              //Set user variables here, can also set global elements
              var userId = data.id;
              var username = data.username;
              document.getElementById("name-holder").innerHTML=username;
            });
          }
        )
      },30000)*/

      //Page swapping

      //Initial state
      let state = {
        "previousPage": "index",
        "currentPage": "index"
      };
      (function initialize() {
        window.history.replaceState(state, null, "");

        render(state);
      })();
      //Navbar links
      var navHistory = document.querySelectorAll('.nav-link-history');
      navHistory.forEach((nav) => {
        //alert(nav)
        nav.addEventListener('click', navClick);
      })

      //Custom event for page show
      function pageShown(ev) {
        console.log('Page', ev.target.id, 'was shown');
      };

      //Pages
      var pages = document.querySelectorAll('.page');
      pages.forEach((pg) => {
        pg.addEventListener('show', pageShown);
      })

      //Navigation function
      function navClick(ev) {
        ev.preventDefault();
        let href = ev.currentTarget.getAttribute("href");
        if (href === state.currentPage) {
          return;
        }
        [state.previousPage, state.currentPage] = [state.currentPage, href];

        history.pushState(state, href, '');
        //alert(JSON.stringify(state))
        document.getElementById('nav-' + state.previousPage).classList.remove('active');
        document.getElementById('nav-' + state.currentPage).classList.add('active');
        document.querySelector('.currentPage').classList.add('d-none');
        document.querySelector('.currentPage').classList.remove('currentPage');
        document.getElementById('page-' + state.currentPage).classList.remove('d-none')
        document.getElementById('page-' + state.currentPage).classList.add('currentPage')
        var title = ' - 3TPT'
        switch (state.currentPage) {
          case "index":
            title = "Dashboard" + title;
            break;
          default:
            title = state.currentPage.charAt(0).toUpperCase() + state.currentPage.slice(1) + title;
        }

        try {
          document.getElementsByTagName('title')[0].innerHTML = title.replace('<', '&lt;').replace('>', '&gt;').replace(' & ', ' &amp; ');
        } catch (e) { }
        document.title = title;
        render(state);
      }

      //On Back
      window.onpopstate = function (event) {
        //alert("location: " + document.location + ", state: " + JSON.stringify(event.state));
        state = event.state
        document.getElementById('nav-' + state.previousPage).classList.remove('active');
        document.getElementById('nav-' + state.currentPage).classList.add('active');
        document.querySelector('.currentPage').classList.add('d-none');
        document.querySelector('.currentPage').classList.remove('currentPage');
        document.getElementById('page-' + state.currentPage).classList.remove('d-none');
        document.getElementById('page-' + state.currentPage).classList.add('currentPage');
        render(state);
      };

      function render() {
        //we can render data here
        $("#page-top").addClass("sidebar-toggled")
        $("#nav-bar").addClass("toggled")
        document.getElementById('page-' + state.currentPage).dispatchEvent(show);
      }

      initSignatureBox(document.getElementById('signature-officer'), document.getElementById('clear-sign-officer'), 800, 400);
      initSignatureBox(document.getElementById('signature-vcom'), document.getElementById('clear-sign-vcom'), 800, 400);
      initSignatureBox(document.getElementById('signature-user'), document.getElementById('clear-sign-user'), 800, 400);
      //set avi max date to today
      document.getElementById("vehavi").setAttribute("max", today);
      document.getElementById("vehavi").setAttribute("min", ayearback);
      
      
      
      let nomove = getInputsByValue("No Move")
      nomove.forEach((nm) => {
        nm.addEventListener('click', function(){
          nm.checked=(confirm("This option has a \"No Move\" risk.\nAre you sure?"))
        });
      })
      
      document.getElementById("evalRisk").addEventListener("click", function(e) {
        setOverallRisk()
      });
    }
    
    /*const radioPanels = [
      {
        title: "Vehicle / Motorcycle Type",
        header: ["Vehicle", "Motorcycle"],
        opts: [
          ["Low", {
            opt: "Same as last detail",
            colspan: 2
          }],
          ["Low", "GP Car/Pickup", "200CC"],
          ["Medium", "Class 3", "800CC"],
          ["High", "Class 4", "800CC"],
        ],
        name: "veh-type"
      }
    ];*/
    
    const formMapping = {
      'journeyfrom': 'Journey From',
      'journeyto': 'Journey To',
      'vehno': 'Vehicle No',
      'vehavi': 'Last AVI Date',
      'drv-experience': 'Driving/Riding Experience',
      'veh-type': 'Vehicle Type',
      'fatigue': 'Fatigue',
      'health': 'Health',
      'weather': 'Weather',
      'familiarity': 'Familiarity',
      'mission': 'Mission Type',
      'no-vcom': 'Driver Experience',
      'servicibility': 'Servicibility',
    };

    let createModalCache = {};
    function initCreateModal() {
      const modalPanes = document.getElementById('modal-create-rac-panes');
      const nextButtons = modalPanes.getElementsByClassName('btn-nextPane');
      for (let i = 0; i < nextButtons.length; i++) {
        nextButtons[i].onclick = function () {
          if(nextButtons[i].parentElement.parentElement.getElementsByClassName('needs-validation').length > 0){
            const form = nextButtons[i].parentElement.parentElement.getElementsByClassName('needs-validation')[0];
            
            if(!form.checkValidity()){
              form.classList.add('was-validated');
              return;
            }
            const fData = new FormData(form);
            const keys = fData.keys();
            let k = keys.next();
            while(k.done !== true){
              console.log(k.value);
              createModalCache[k.value] = fData.get(k.value);
              k = keys.next();
            }
          }
          
          if(nextButtons[i].getAttribute('data-action') !== undefined && nextButtons[i].getAttribute('data-action') !== null && nextButtons[i].getAttribute('data-action') !== ''){
            const action = nextButtons[i].getAttribute('data-action');
            if(action.includes('save-sign')){
              const target = nextButtons[i].getAttribute('data-sign-target');
              const formName = nextButtons[i].getAttribute('data-sign-name');
              
              createModalCache[formName] = document.getElementById(target).toDataURL();
            }
            
            if(action.includes('gen-summary')){
              const summaryContainer = document.getElementById(nextButtons[i].getAttribute('data-summary'));
              while(summaryContainer.lastChild) summaryContainer.removeChild(summaryContainer.lastChild);
              
              const keys = Object.keys(formMapping);
              const table = document.createElement('table');
              table.className = 'table';
              
              for(let j = 0; j < keys.length; j++){
                table.appendChild(
                  createElement('tr', {}, 
                    createElement('td', {}, formMapping[keys[j]]),
                    createElement('td', {}, createModalCache[keys[j]]),
                  )
                );
              }
              
              //handle signatures
              table.appendChild(
                createElement('tr', {}, 
                  createElement('td', {}, 'Countersigning Officer'),
                  createElement('td', {}, createModalCache['officerrank'] + ' ' + createModalCache['officername']),
                )
              );

              table.appendChild(
                createElement('tr', {}, 
                  createElement('td', {attributes: {colspan: 2}},
                    createElement('img', {style: {width: '80%', maxWidth: '600px'}, src: createModalCache['officersign']})
                  )
                )
              );

              table.appendChild(
                createElement('tr', {}, 
                  createElement('td', {}, 'Vehicle Commander'),
                  createElement('td', {}, createModalCache['vcomrank'] + ' ' + createModalCache['vcomname']),
                )
              );

              table.appendChild(
                createElement('tr', {}, 
                  createElement('td', {attributes: {colspan: 2}}, 
                    createElement('img', {style: {width: '80%', maxWidth: '600px'}, src: createModalCache['vcomsign']})
                  )
                )
              );
              
              summaryContainer.appendChild(table);
            }
          }
          
          const curTranslate = parseInt(modalPanes.style.transform.split('(')[1].split(')')[0].replace('%', ''));
          modalPanes.style.transform = 'translateX(' + (curTranslate - 100) + '%)';
          
         
        }
      }
      const prevButtons = modalPanes.getElementsByClassName('btn-prevPane');
      for (let i = 0; i < prevButtons.length; i++) {
        prevButtons[i].onclick = function () {
          const curTranslate = parseInt(modalPanes.style.transform.split('(')[1].split(')')[0].replace('%', ''));
          modalPanes.style.transform = 'translateX(' + (curTranslate + 100) + '%)';
        }
      }
      
      $('#modal-create-rac').on('hide.bs.modal', () => {
          modalPanes.style.transform = 'translateX(0)';
          createModalCache = {};
          
          //reset all form data
          var inputElements = document.getElementsByTagName("input");
          for (var i=0; i < inputElements.length; i++) {
            if (inputElements[i].type == "text" || inputElements[i].type == "number" || inputElements[i].type == "date" || inputElements[i].type == "time") {
              inputElements[i].value = "";
              if (inputElements[i].type != "number"){
                inputElements[i].type = "text";
              }
            }
            else if(inputElements[i].type == "radio" && inputElements[i].checked == 1){
              inputElements[i].checked = 0;
            }
          }
          $("textarea").val("");
          $("form").removeClass("was-validated")
          document.getElementById("haveread").checked = 0;
        document.getElementById("officerChk").checked = 0;
          var canvasClear = document.getElementsByClassName("canvas-clear")
          Array.prototype.forEach.call(canvasClear, function(cv) {
            cv.click()
          });
          $(".overall-risk").text("");
        });
      
      /*const container = document.getElementById('modal-create-rac-panes');
      for(let i=0;i<radioPanels.length;i++){
        const curData = radioPanels[i];
        const pane = document.createElement('div');
        pane.className = 'modal-pane';
        pane.style.textAlign = 'center';
        
        const title = createTextNode('h5', curData.title);
        const formWrapper = document.createElement('form');
        formWrapper.className = 'needs-validation';
        formWrapper.setAttribute('novalidate', true);
        const table = document.createElement('table');
        table.className = 'table';
        table.style.margin = '8px';
        table.style.width = 'calc(100% - 16px)';
        
        const tableHead = document.createElement('thead');
        const headRow = document.createElement('tr');
        for(let j=0;j<curData.header.length;j++){
          headRow.appendChild(createTextNode('th', curData.header[j]));
        }
        headRow.appendChild(document.createElement('th'));
        tableHead.appendChild(headRow);
        
        const tableBody = document.createElement('tbody');
        for(let j=0;j<curData.opts.length;j++){
          const row = document.createElement('tr');
          for(let k=1;k<curData.opts[j].length;k++){
            if(typeof(curData.opts[j][k]) === 'object'){
              const cell = createTextNode('td', curData.opts[j][k].opt);
              if(curData.opts[j][k].colspan !== undefined)
                cell.setAttribute('colspan', curData.opts[j][k].colspan);
              row.appendChild(cell);
            }else{
              row.appendChild(createTextNode('td', curData.opts[j][k]));
            }
          }
          const buttonCell = document.createElement('td');
          buttonCell.style.position = 'relative';
          const radio = document.createElement('input');
          radio.className = 'form-check-input';
          radio.type = 'radio';
          radio.name = curData.name;
          radio.value = curData.opts[j][0];
          radio.setAttribute('required', true);
          
          buttonCell.appendChild(radio);
          row.appendChild(buttonCell);
          tableBody.appendChild(row);
        }
        
        table.appendChild(tableHead);
        table.appendChild(tableBody);
        formWrapper.appendChild(table);
        pane.appendChild(title);
        pane.appendChild(formWrapper);
        container.appendChild(pane);
      }*/
    }

    function createElement(type, props){
      const ret = document.createElement(type);
      recursiveSet(ret, props);

      if(arguments.length > 2){
        for(let i=2;i<arguments.length;i++){
          if(typeof(arguments[i]) === 'string' || typeof(arguments[i]) === 'number')
            ret.textContent = arguments[i];
          else if(typeof(arguments[i]) === 'object')
            ret.appendChild(arguments[i]);
        }
      }

      return ret;
    }

    function recursiveSet(node, props){
      const keys = Object.keys(props);
      for(let i=0;i<keys.length;i++){
        const k = keys[i];
        if(k === 'attributes'){
          recursiveSetAttribute(node, props[k]);
        }else if(typeof(props[k]) === 'object'){
          recursiveSet(node[k], props[k]);
        }else{
          node[k] = props[k];
        }
      }
    }

    function recursiveSetAttribute(node, props){
      const keys = Object.keys(props);
      for(let i=0;i<keys.length;i++){
        const k = keys[i];
        node.setAttribute(k, props[k]);
      }
    }

    function initSignatureBox(cvs, clearBtn, canvasWidth, canvasHeight) {
      const canvas = cvs;
      const ctx = canvas.getContext('2d');
      let isPainting = false;

      //setup
      canvas.width = canvasWidth;
      canvas.height = canvasHeight;

      ctx.lineWidth = 6;
      ctx.lineJoin = 'round';
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#F00';

      const onPaint = (e) => {
        if (!isPainting) return;

        const ratio = (canvasWidth / canvas.clientWidth);

        ctx.lineTo(ratio * e.offsetX, ratio * e.offsetY);
        ctx.stroke();
      };

      const onTouchPaint = (e) => {
        if (!isPainting) return;

        const bRect = canvas.getBoundingClientRect();
        const ratio = (canvasWidth / bRect.width);

        ctx.lineTo(ratio * (e.targetTouches[0].clientX - bRect.x), ratio * (e.targetTouches[0].clientY - bRect.y));
        ctx.stroke();
      };

      const stopDrawing = (e) => {
        if (!isPainting) return;

        isPainting = false;
        canvas.removeEventListener('mousemove', onPaint, false);
        canvas.removeEventListener('touchmove', onTouchPaint, false);
      };

      const startDrawing = (e) => {
        if (isPainting) return;

        isPainting = true;
        const ratio = (canvasWidth / canvas.clientWidth);

        ctx.beginPath();
        ctx.moveTo(ratio * e.offsetX, ratio * e.offsetY);

        canvas.addEventListener('mousemove', onPaint, false);
        canvas.addEventListener('touchmove', onTouchPaint, false);
      };

      const clearCanvas = () => {
        ctx.clearRect(0, 0, canvasWidth, canvasHeight);
      }

      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('touchstart', startDrawing);
      canvas.addEventListener('touchend', stopDrawing);

      if (clearBtn !== undefined) {
        clearBtn.addEventListener('click', clearCanvas);
      }
    }
    
    
      var officerChk = document.getElementById('officerChk')
      var officerPage = document.getElementById('officerPage')
      var officerForm = document.getElementById('officerForm')
      officerChk.onclick=function noOfficer(){
        if (officerChk.checked==true){
        officerPage.classList.add('d-none');
        officerForm.classList.remove('needs-validation')
      }
      else{
        officerPage.classList.remove('d-none');
        officerForm.classList.add('needs-validation')
      }
    }
    
    function getInputsByValue(value){
        var allInputs = document.getElementsByTagName("input");
        var results = [];
        for(var x=0;x<allInputs.length;x++)
            if(allInputs[x].value == value)
                results.push(allInputs[x]);
        return results;
    }
    
    function setOverallRisk(){
      var risk
      var riskcolor
      var medRisks = []
      var highRisks = []
      var noMoves = []
      var note = "Risks to take note of:"
      
      var low = 0
      getInputsByValue("Low").forEach((l)=>{
        if (l.checked){++low}
      })
      
      
      var med = 0
      getInputsByValue("Medium").forEach((m)=>{
        if (m.checked){
          ++med;
          medRisks.push(m);
        }
      })
      
      
      var high = 0
      getInputsByValue("High").forEach((h)=>{
        if (h.checked){
          ++high;
          highRisks.push(h);
        }
      })
      
      
      var nm = 0
      getInputsByValue("No Move").forEach((n)=>{
        if (n.checked){
          ++nm;
          noMoves.push(n);
        }
      })
      
      
      
      if (nm>0||high>3){
        risk = "No Move"
        riskcolor = "grey"
      }
      else if(high>0||med>5){
        risk = "High"
        riskcolor = "red"
      }
      else if(med>0){
        risk = "Medium"
        riskcolor = "orange"
      }
      else{
        risk = "Low"
        riskcolor = "green"
      }
      
      if (med>0){
        note +="\n(Medium)"
        medRisks.forEach((mr)=>{
          var header = mr.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByTagName('h5')[0].innerText
          var row = mr.parentElement.parentElement.getElementsByTagName('td')[0].innerText
          note += "\n"+ header + ": " + row;
        })
      }
      if (high>0){
        note +="\n(High)"
        highRisks.forEach((hr)=>{
          var header = hr.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByTagName('h5')[0].innerText
          var row = hr.parentElement.parentElement.getElementsByTagName('td')[0].innerText
          note += "\n"+ header + ": " + row;
        })
      }
      if (nm>0){
        note +="\n(No Move)"
        noMoves.forEach((nmr)=>{
          var header = nmr.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByTagName('h5')[0].innerText
          var row = nmr.parentElement.parentElement.getElementsByTagName('td')[0].innerText
          note += "\n"+ header + ": " + row;
        })
      }
      
      
      if (risk=="Medium"||risk=="High"||risk=="No Move"){
        $("#vcomsafetymeasures").removeClass("d-none")
        $("#officersafetymeasures").removeClass("d-none")
        $(".takenote").text(note);
      }
      else{
        $("#vcomsafetymeasures").addClass("d-none")
        $("#officersafetymeasures").addClass("d-none")
        $(".takenote").text("");
      }
      
      
      // var overallRisk = document.getElementsByClassName("overall-risk")
      // Array.prototype.forEach.call(overallRisk, function(or) {
      //       or.innerHTML = risk
      // });
      
      $(".overall-risk").css({ 'color': riskcolor, 'font-size': '120%', 'font-weight': 'bold'}).text(risk);
      
    }
    /*
    RAC Modal conditions, rules & stuff:
    All panes required to select 1 radio btn
    Txtbox and canvas fields required
    Canvas allow retrying
    If no move radio btn selected, do a popup/prompt but still allow to continue
    Overall risk = highest risk, or if med > 5 = high, high > 5 = no move

    To do:
    When entering modal, lock user movement of whatever's behind (no back, etc)
    */

      //     async function reloadDetailDataTable(){

      //       //ajax get request for table data, store in an array (reuse detailData)
      //       var url = "/users/"+userId+"/details";
      //       const response = await fetch(url);
      //       const detailTableData = await response.json();
      //       console.log(detailTableData)

      //       //clear table
      //        $("#userDetailTableInner tbody tr").remove();

      //       //load table (reuse)

      //       for(let i=0;i<detailTableData.length;i++){
      //         const row = document.createElement('tr');
      //         row.appendChild(createTextNode('td', detailTableData[i][0]));
      //         row.appendChild(createTextNode('td', detailTableData[i][1]));
      //         row.appendChild(createTextNode('td', detailTableData[i][2]));
      //         const btnCell = document.createElement('td');
      //         const createBtn = document.createElement('button');
      //         createBtn.textContent = 'Create';
      //         createBtn.className = 'btn btn-primary';
      //         createBtn.onclick = function(){
      //           $('#modal-create-rac').modal('show');
      //         }

      //         const viewBtn = document.createElement('button');
      //         viewBtn.textContent = 'View';
      //         viewBtn.className = 'btn btn-secondary';
      //         viewBtn.style.marginLeft = '4px';
      //         btnCell.appendChild(createBtn);
      //         btnCell.appendChild(viewBtn);
      //         row.appendChild(btnCell);
      //         document.getElementById('userDetailTableInner').children[1].appendChild(row);
      //       }
      //     }
  </script>
</body>

</html>